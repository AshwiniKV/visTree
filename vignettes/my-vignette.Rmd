---
title: "visTree: visualization of subgroups for decision trees"
author: "Ashwini Venkatasubramaniam and Julian Wolfson"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

visTree provides a visualization to characterize subgroups generated by a decision tree. Each individual terminal node identified by a decision tree corresponds to a subplot in the visualization. 

This document introduces you to the basic set of tools provided by the package. 

```{r, fig.show='hold'}
library(visTree)
data("blsdata")
names(blsdata)
library(partykit)
names(blsdata)[c(4, 6, 12, 19, 21, 22, 23, 24, 25)]<-c("skcal", "srvgssb", "edeq15", "freqff","rest.eating", "disinhibition", "hunger", "liking", "wanting")
newblsdata<-blsdata[,c(7,21, 22,23, 24, 25, 26)]
```

## Continuous outcome 


```{r, fig.show='hold', out.width = '90%',fig.align = 'center', fig.height = 9, ,fig.width = 12}
potentialtree<-ctree(kcal24h0~., data = newblsdata, control = ctree_control(mincriterion = 0.95))
visTree(potentialtree, text.axis = 1.3, text.label = 1.25,text.bar = 1.36, color.type = 1, alpha = 0.5)
```

## Categorical outcome 

```{r, fig.show='hold', include = FALSE}
blsdataedit<-blsdata[,-7]
blsdataedit$bin<-0
blsdataedit$bin<-cut(blsdata$kcal24h0, unique(quantile(blsdata$kcal24h0)), include.lowest = TRUE, dig.lab = 4)
```


```{r, fig.show='hold', out.width = '90%',fig.align = 'center', fig.height = 9, ,fig.width = 12}
potentialtree<-ctree(bin~hunger+rrvfood+rest.eating+liking+wanting+disinhibition, data = blsdataedit, control = ctree_control(mincriterion = 0.85))
visTree(potentialtree, interval = T,  color.type = 1, alpha = 0.6)
```

## Repeated Splits 
```{r, fig.show='hold', out.width = '95%',fig.align = 'center', fig.height = 9, ,fig.width = 14}
potentialtree<-ctree(kcal24h0~skcal+hunger+rrvfood+rest.eating+liking+wanting+age, data = blsdata, control = ctree_control(mincriterion = 0.95))
visTree(potentialtree, interval = F, color.type = 1, alpha = 0.5, text.main = 1.4, text.axis = 1.3, text.bar = 1.05, text.label = 1.15, text.title = 2)

```

## Other Trees, (e.g., Rpart)

```{r, fig.show='hold', out.width = '98%',fig.align = 'center', fig.height = 9, ,fig.width = 16}
potentialtree<-rpart(kcal24h0~., data = newblsdata, control = rpart.control(cp = 0.015))
visTree(potentialtree, text.bar = 1.05, text.label = 1.15, text.round = 1)
```

## Display controls
